<div class="max-w-5xl mx-auto">
  <% if facility.images.attached? %>
    <% begin %>
      <% img    = facility.images.first %>
      <% small  = img.variant(resize_to_fit: [768, 512],    saver: { quality: 75, strip: true }) %>
      <% medium = img.variant(resize_to_fit: [1200, 800],   saver: { quality: 75, strip: true }) %>
      <% large  = img.variant(resize_to_fit: [1600, 1067],  saver: { quality: 75, strip: true }) %>

      <%= picture_tag(
            url_for(large),
            sources: [
              { srcset: [
                  "#{url_for(small,  format: :avif)} 768w",
                  "#{url_for(medium, format: :avif)} 1200w",
                  "#{url_for(large,  format: :avif)} 1600w"
                ].join(", "),
                type: "image/avif",
                sizes: "100vw" },
              { srcset: [
                  "#{url_for(small,  format: :webp)} 768w",
                  "#{url_for(medium, format: :webp)} 1200w",
                  "#{url_for(large,  format: :webp)} 1600w"
                ].join(", "),
                type: "image/webp",
                sizes: "100vw" }
            ],
            img: {
              alt: facility.title,
              loading: "lazy",
              decoding: "async",
              class: "block w-full h-auto rounded-md object-cover",
              width: 1600, height: 1067
            }
          ) %>
    <% rescue ActiveStorage::FileNotFoundError, Errno::ENOENT %>
      <%= image_tag "sample.png", class: "block w-full h-auto rounded-md", loading: "lazy", decoding: "async" %>
    <% end %>
  <% else %>
    <%= image_tag "sample.png", class: "block w-full h-56 rounded-md", loading: "lazy", decoding: "async" %>
  <% end %>
</div>
